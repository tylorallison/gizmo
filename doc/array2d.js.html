<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>array2d.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Animation.html">Animation</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Animation.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Animation.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Animation.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Animation.html#disable">disable</a></li><li data-type='method' style='display: none;'><a href="Animation.html#enable">enable</a></li><li data-type='method' style='display: none;'><a href="Animation.html#onTimer">onTimer</a></li><li data-type='method' style='display: none;'><a href="Animation.html#postrender">postrender</a></li><li data-type='method' style='display: none;'><a href="Animation.html#prerender">prerender</a></li><li data-type='method' style='display: none;'><a href="Animation.html#render">render</a></li><li data-type='method' style='display: none;'><a href="Animation.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="Animation.html#subrender">subrender</a></li><li data-type='method' style='display: none;'><a href="Animation.html#toString">toString</a></li></ul></li><li><a href="Animator.html">Animator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Animator.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Animator.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Animator.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Animator.html#disable">disable</a></li><li data-type='method' style='display: none;'><a href="Animator.html#enable">enable</a></li><li data-type='method' style='display: none;'><a href="Animator.html#postrender">postrender</a></li><li data-type='method' style='display: none;'><a href="Animator.html#prerender">prerender</a></li><li data-type='method' style='display: none;'><a href="Animator.html#render">render</a></li><li data-type='method' style='display: none;'><a href="Animator.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="Animator.html#subrender">subrender</a></li><li data-type='method' style='display: none;'><a href="Animator.html#toString">toString</a></li></ul></li><li><a href="Array2D.html">Array2D</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Array2D.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#getidx">getidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#getij">getij</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#idxfromdir">idxfromdir</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#idxfromij">idxfromij</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#idxsAdjacent">idxsAdjacent</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#idxsBetween">idxsBetween</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#ifromidx">ifromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#ijfromidx">ijfromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#jfromidx">jfromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#setidx">setidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#setij">setij</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#toString">toString</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.idxfromdir">idxfromdir</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.idxfromij">idxfromij</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.idxsBetween">idxsBetween</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.ifromidx">ifromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.ijfromidx">ijfromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.jfromidx">jfromidx</a></li><li data-type='method' style='display: none;'><a href="Array2D.html#.resize">resize</a></li></ul></li><li><a href="Bounds.html">Bounds</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Bounds.html#contains">contains</a></li><li data-type='method' style='display: none;'><a href="Bounds.html#containsXY">containsXY</a></li><li data-type='method' style='display: none;'><a href="Bounds.html#copy">copy</a></li><li data-type='method' style='display: none;'><a href="Bounds.html#extend">extend</a></li><li data-type='method' style='display: none;'><a href="Bounds.html#intersects">intersects</a></li><li data-type='method' style='display: none;'><a href="Bounds.html#overlaps">overlaps</a></li></ul></li><li><a href="Evt.html">Evt</a></li><li><a href="EvtSystem.html">EvtSystem</a></li><li><a href="FileLoader.html">FileLoader</a></li><li><a href="Game.html">Game</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Game.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Game.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Game.html#cfinal">cfinal</a></li><li data-type='method' style='display: none;'><a href="Game.html#cpost">cpost</a></li><li data-type='method' style='display: none;'><a href="Game.html#cpre">cpre</a></li><li data-type='method' style='display: none;'><a href="Game.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Game.html#init">init</a></li><li data-type='method' style='display: none;'><a href="Game.html#load">load</a></li><li data-type='method' style='display: none;'><a href="Game.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="Game.html#start">start</a></li><li data-type='method' style='display: none;'><a href="Game.html#toString">toString</a></li></ul></li><li><a href="GameState.html">GameState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="GameState.html#init">init</a></li><li data-type='method' style='display: none;'><a href="GameState.html#load">load</a></li><li data-type='method' style='display: none;'><a href="GameState.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="GameState.html#start">start</a></li><li data-type='method' style='display: none;'><a href="GameState.html#stop">stop</a></li></ul></li><li><a href="Generator.html">Generator</a></li><li><a href="Gizmo.html">Gizmo</a><ul class='members'><li data-type='member' style='display: none;'><a href="Gizmo.html#gctx">gctx</a></li><li data-type='member' style='display: none;'><a href="Gizmo.html#gid">gid</a></li><li data-type='member' style='display: none;'><a href="Gizmo.html#tag">tag</a></li><li data-type='member' style='display: none;'><a href="Gizmo.html#.gctx">gctx</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Gizmo.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#cfinal">cfinal</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#cpost">cpost</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#cpre">cpre</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#toString">toString</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#.ignore">ignore</a></li><li data-type='method' style='display: none;'><a href="Gizmo.html#.listen">listen</a></li></ul></li><li><a href="GizmoContext.html">GizmoContext</a><ul class='members'><li data-type='member' style='display: none;'><a href="GizmoContext.html#ctxid">ctxid</a></li><li data-type='member' style='display: none;'><a href="GizmoContext.html#game">game</a></li><li data-type='member' style='display: none;'><a href="GizmoContext.html#tag">tag</a></li><li data-type='member' style='display: none;'><a href="GizmoContext.html#userActive">userActive</a></li><li data-type='member' style='display: none;'><a href="GizmoContext.html#.main">main</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="GizmoContext.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="GizmoContext.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="GizmoContext.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="GizmoContext.html#toString">toString</a></li></ul></li><li><a href="GizmoData.html">GizmoData</a><ul class='methods'><li data-type='method' style='display: none;'><a href="GizmoData.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#toString">toString</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.applySchema">applySchema</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.eachInPath">eachInPath</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.eachInTrunk">eachInTrunk</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.findInPath">findInPath</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.findInTrunk">findInTrunk</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.path">path</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.root">root</a></li><li data-type='method' style='display: none;'><a href="GizmoData.html#.xspec">xspec</a></li></ul></li><li><a href="Grid.html">Grid</a></li><li><a href="Rect.html">Rect</a></li><li><a href="Sfx.html">Sfx</a></li><li><a href="Sketch.html">Sketch</a><ul class='members'><li data-type='member' style='display: none;'><a href="Sketch.html#active">active</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#alpha">alpha</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#assetTag">assetTag</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#done">done</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#done">done</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#height">height</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#smoothing">smoothing</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#ttl">ttl</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#ttl">ttl</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#ttl">ttl</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#width">width</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#.renderable">renderable</a></li><li data-type='member' style='display: none;'><a href="Sketch.html#.zero">zero</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Sketch.html#atLink">atLink</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#atUnlink">atUnlink</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#disable">disable</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#enable">enable</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#postrender">postrender</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#prerender">prerender</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#render">render</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#reset">reset</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#subrender">subrender</a></li><li data-type='method' style='display: none;'><a href="Sketch.html#toString">toString</a></li></ul></li><li><a href="Sprite.html">Sprite</a></li><li><a href="UiCanvas.html">UiCanvas</a></li><li><a href="UiText.html">UiText</a></li><li><a href="UiView.html">UiView</a></li><li><a href="UpdateSystem.html">UpdateSystem</a></li></ul><h3>Mixins</h3><ul><li><a href="ExtEvtEmitter.html">ExtEvtEmitter</a></li></ul><h3><a href="global.html">Global</a></h3>
    
</nav>

<div id="main">
    
    <h1 class="page-title">array2d.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>export { Array2D };

import { Direction } from './direction.js';
import { GizmoData } from './gizmoData.js';
import { Schema } from './schema.js';

/**
 * Implements a 2-dimensional array and methods for indexing and accessing data within
 * @extends GizmoData
 */
class Array2D extends GizmoData {
    /** @member {string} Array2D#cols=16 - columns in 2d array */
    static { Schema.apply(this, 'cols', { readonly: true, dflt: 16 }); }
    /** @member {string} Array2D#rows=16 - rows in 2d array */
    static { Schema.apply(this, 'rows', { readonly: true, dflt: 16 }); }
    /** @member {string} Array2D#length - length of flat array */
    static { Schema.apply(this, 'length', { readonly: true, parser: (o,x) => o.cols*o.rows }); }
    /** @member {string} Array2D#entries - array storage */
    static { Schema.apply(this, 'entries', { link: 'array', readonly: true, parser: (o,x) => x.entries || [] }); }

    // STATIC METHODS ------------------------------------------------------
    /**
     * Returns the column index (i) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @param {int} cols - number of columns in 2d array
     * @param {int} length - length of 2d array
     * @returns {int}
     */
    static ifromidx(idx, cols, length=undefined) {
        if (idx &lt; 0) return -1;
        if (length &amp;&amp; idx >= length) return -1;
        return idx % cols;
    }

    /**
     * Returns the row index (j) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @param {int} cols - number of columns in 2d array
     * @param {int} length - length of 2d array
     * @returns {int}
     */
    static jfromidx(idx, cols, length=undefined) {
        if (idx &lt; 0) return -1;
        if (length &amp;&amp; idx >= length) return -1;
        return Math.floor(idx/cols);
    }

    /**
     * Returns the column and row indices ([i,j]) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @param {int} cols - number of columns in 2d array
     * @param {int} length - length of 2d array
     * @returns {int[]}
     */
    static ijfromidx(idx, cols, length=undefined) {
        if (idx &lt; 0) return -1;
        if (length &amp;&amp; idx >= length) return -1;
        return [idx % this.cols, Math.floor(idx/this.cols)];
    }

    /**
     * Returns the flat index (idx) from the given column and row indices (i,j)
     * @param {int} i - column index
     * @param {int} j - row index
     * @param {int} cols - number of columns in 2d array
     * @param {int} rows - number of rows in 2d array
     * @returns {int}
     */
    static idxfromij(i, j, cols, rows) {
        if (i >= cols) return -1;
        if (j >= rows) return -1;
        return i + cols*j;
    }

    /**
     * Returns the adjacent flat index based on given index and {@link Direction}
     * @param {int} idx - starting flat array index
     * @param {Direction} dir - direction of adjacent index requested
     * @param {int} cols - number of columns in 2d array
     * @param {int} rows - number of rows in 2d array
     * @returns {int}
     */
    static idxfromdir(idx, dir, cols, rows) {
        return this.idxfromij(this.ifromidx(idx, cols) + Direction.asX(dir), this.jfromidx(idx, cols) + Direction.asY(dir), cols, rows);
    }

    /**
     * Generator that yields all (flat) indexes between two given points (indices) using Bresenham's line algorithm
     * @generator
     * @param {int} idx1 - flat index of point one
     * @param {int} idx2 - flat index of point two
     * @param {int} cols - number of columns in 2d array
     * @param {int} rows - number of rows in 2d array
     * @param {int} length - length of array
     * @yields {int}
     */
    static *idxsBetween(idx1, idx2, cols, rows, length=undefined) {
        let i1 = this.ifromidx(idx1, cols, length);
        let j1 = this.jfromidx(idx1, cols, length);
        let i2 = this.ifromidx(idx2, cols, length);
        let j2 = this.jfromidx(idx2, cols, length);
        for (const [i,j] of Util.pixelsInSegment(i1, j1, i2, j2)) {
            yield this.idxfromij(i, j, cols, rows);
        }
    }

    /**
     * Resizes the given 2d array and creates a new 2d array and optionally shifts array entries based on given offsets.  Any out-of-bounds data is lost.
     * @param {Array2D} a2d - 2d array to resize
     * @param {i} cols - number of columns for new array
     * @param {i} rows - number of rows for new array
     * @param {i} [offi=0] - column offset for original array data
     * @param {i} [offj=0] - row offset for original array data
     * @returns {int}
     */
    static resize(a2d, cols, rows, offi=0, offj=0) {
        // re-align data
        let nentries = new Array(rows*cols);
        for (let i=0; i&lt;cols; i++) {
            for (let j=0; j&lt;rows; j++) {
                let oi = i+offi;
                let oj = j+offj;
                if (oi >= 0 &amp;&amp; oi &lt; this.cols &amp;&amp; oj >= 0 &amp;&amp; oj &lt; this.rows) {
                    let oidx = this.constructor.idxfromij(oi, oj, a2d.cols, a2d.rows);
                    let nidx = this.constructor.idxfromij(i, j, cols, rows);
                    nentries[nidx] = a2d.entries[oidx];
                }
            }
        }
        return new Array2D({ rows: rows, cols: cols, entries: nentries });
    }

    // METHODS -------------------------------------------------------------
    /**
     * Returns the column index (i) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @returns {int}
     */
    ifromidx(idx) {
        if (idx &lt; 0) return -1;
        if (idx >= this.length) return -1;
        return idx % this.cols;
    }

    /**
     * Returns the row index (j) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @returns {int}
     */
    jfromidx(idx) {
        if (idx &lt; 0) return -1;
        if (idx >= this.length) return -1;
        return Math.floor(idx/this.cols);
    }

    /**
     * Returns the column and row indices ([i,j]) from the given flat index (idx)
     * @param {int} idx - flat array index
     * @returns {int[]}
     */
    ijfromidx(idx) {
        if (idx &lt; 0) return -1;
        if (idx >= this.length) return -1;
        return [idx % this.cols, Math.floor(idx/this.cols)];
    }

    /**
     * Returns the flat index (idx) from the given column and row indices (i,j)
     * @param {int} i - column index
     * @param {int} j - row index
     * @returns {int}
     */
    idxfromij(i,j) {
        if (i &lt; 0) return -1;
        if (j &lt; 0) return -1;
        if (i >= this.cols) return -1;
        if (j >= this.rows) return -1;
        return i + this.cols*j;
    }

    /**
     * Returns the adjacent flat index based on given index and {@link Direction}
     * @param {int} idx - starting flat array index
     * @param {Direction} dir - direction of adjacent index requested
     * @returns {int}
     */
    idxfromdir(idx, dir) {
        return this.idxfromij(this.ifromidx(idx) + Direction.asX(dir), this.jfromidx(idx) + Direction.asY(dir));
    }

    /**
     * Generator that yields all (flat) indexes between two given points (indices) using Bresenham's line algorithm
     * @generator
     * @param {int} idx1 - flat index of point one
     * @param {int} idx2 - flat index of point two
     * @yields {int}
     */
    *idxsBetween(idx1, idx2) {
        let i1 = this.ifromidx(idx1);
        let j1 = this.jfromidx(idx1);
        let i2 = this.ifromidx(idx2);
        let j2 = this.jfromidx(idx2);
        for (const [i,j] of Util.pixelsInSegment(i1, j1, i2, j2)) {
            yield this.idxfromij(i,j);
        }
    }

    /**
     * Determines if the given two indices are adjacent to each other.
     * @param {int} idx1 - index 1
     * @param {int} idx2 - index 2
     * @returns  {boolean}
     */
    idxsAdjacent(idx1, idx2) {
        for (const dir of Direction.all) {
            if (this.idxfromdir(idx1, dir) === idx2) return true;
        }
        return false;
    }

    // -- accessor methods
    /**
     * retrieve array value for the given column, row (i,j) indices
     * @param {int} i - column index
     * @param {int} j - row index
     * @returns {*}
     */
    getij(i, j) {
        let idx = this.idxfromij(i, j);
        return this.entries[idx];
    }

    /**
     * retrieve array value for the given flat index (idx)
     * @param {int} idx - flat index
     * @returns {*}
     */
    getidx(idx) {
        return this.entries[idx];
    }

    /**
     * set array value for the given column, row (i,j) indices
     * @param {int} i - column index
     * @param {int} j - row index
     * @param {*} v - value to set
     */
    setij(i, j, v) {
        let idx = this.idxfromij(i, j);
        this.entries[idx] = v;
    }

    /**
     * set array value for the given flat index (idx)
     * @param {int} idx - flat index
     * @param {*} v - value to set
     */
    setidx(idx, v) {
        this.entries[idx] = v;
    }

    /**
     * clear all contents of the array
     */
    clear() {
        this.entries.splice(0);
    }

    // -- iterators
    /**
     * iterator that returns all array contents
     * @generator
     * @yields {*}
     */
    *[Symbol.iterator]() {
        for (let i=0; i&lt;this.length; i++) {
            yield *this.entries[i];
        }
    }

    /**
     * An array element filter is used to determine if a given array element matches and is used for array predicate functions.
     * @callback Array2D~filter
     * @param {*} v - value to be evaluated
     * @returns {boolean} - indicates if given value matches
     */

    /**
     * generator that returns all array elements that match the given filter
     * @param {Array2D~filter} filter 
     */
    *find(filter=(v) => true) {
        for (let i=0; i&lt;this.length; i++) {
            let v = this.entries[i];
            if (filter(v)) yield [i, v];
        }
    }

}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.0</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
